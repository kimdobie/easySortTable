//jquery.easySortTable.js - version 1.0

var sortTableVars={};sortTableVars.noSortClass="noSort";sortTableVars.sortHeaderClass="sortHeader";sortTableVars.headerLinkTitle="Sort this column";sortTableVars.alreadySortedAscendingClass="sortedAscending";sortTableVars.alreadySortedDescendingClass="sortedDescending";sortTableVars.sortArrowClass="sortArrow";sortTableVars.ascSortArrow="&nbsp;&darr;";sortTableVars.descSortArrow="&nbsp;&uarr;";sortTableVars.sortDirectionAscClass="sortDirectionAsc";sortTableVars.sortDirectionDesClass="sortDirectionDes";
sortTableVars.sortKeyClassStart="dataType_";sortTableVars.sortFunctionClassStart="sort_";sortTableVars.sortKeyClass="sortKey";sortTableVars.sortedColumnClass="sortedCol";sortTableVars.sortHeaderRowClass="sortHeaderRow";sortTableVars.secondarySortClass="secondarySort_";jQuery.fn.alternateRowColors=function(){jQuery("tbody tr:odd",this).removeClass("odd").addClass("even");jQuery("tbody tr:even",this).removeClass("even").addClass("odd");return this};
jQuery.fn.easySortTable=function(){return this.each(function(){var a;a=jQuery(this).find("tr."+sortTableVars.sortHeaderRowClass).length>0?jQuery(this).find("tr."+sortTableVars.sortHeaderRowClass).eq(0):jQuery(this).find("thead").length>0?jQuery(this).find("thead tr:last"):jQuery(this).find("tr:first");if(jQuery(a).parents("thead").length==0){jQuery(this).prepend("<thead></thead>");jQuery(this).find("thead:first").append(a)}jQuery(a).children().each(function(b){jQuery(this).setSortLink(b)});jQuery(this).alternateRowColors()})};
jQuery.fn.setSortLink=function(a,b){if(!jQuery(this).hasClass(sortTableVars.noSortClass)){if(a==undefined||a==""){b=jQuery(this).parents("tr").eq(0);var d;jQuery(this).each(function(){d=this});jQuery(b).find("th").each(function(f){if(this==d)a=f});if(a==undefined||a=="")jQuery(b).find("td").each(function(f){if(this==d)a=f})}var g=this,h=true;b="";if(jQuery(g).find("."+sortTableVars.sortHeaderClass).length>0){g=jQuery(g).find("."+sortTableVars.sortHeaderClass).eq(0);jQuery(g).removeClass(sortTableVars.sortHeaderClass);
g=g;h=false}jQuery(g).wrapInner('<a href="javascript:void(0)"></a>');var i=jQuery(g).find("a:first");i.attr("title",sortTableVars.headerLinkTitle).addClass(sortTableVars.sortHeaderClass);if(jQuery(g).hasClass(sortTableVars.alreadySortedAscendingClass))b=1;if(jQuery(g).hasClass(sortTableVars.alreadySortedDescendingClass))b=-1;i.setSortArrow(b,false);h&&i.css("display","block");i.click(function(){jQuery(this).sortTableColumn(a)})}return this};
jQuery.fn.setSecondarySort=function(){jQuery(this).removeSecondarySort();for(var a=jQuery(this).sortGetParentCell(),b=sortTableVars.secondarySortClass,d=0;d<arguments.length;d++)if(typeof arguments[d]=="object"){if(d!=0)b+="_";var g=jQuery(arguments[d]).sortGetTableCellIndex();b+=g+"_";b+=arguments[d+1]!="object"&&arguments[d+1]!=undefined?arguments[d+1]:"0"}jQuery(a).addClass(b)};
jQuery.fn.setSecondarySortByIndex=function(){if(arguments.length%2!=0){alert("Odd number of arguments sent to the setSecondarySortByIndex method");return this}for(var a=jQuery(this).sortGetParentCell(),b=sortTableVars.secondarySortClass,d=0;d<arguments.length;d++){if(d!=0)b+="_";b+=arguments[d]}jQuery(a).addClass(b)};
jQuery.fn.removeSecondarySort=function(){var a=jQuery(this).sortCheckForClass(sortTableVars.secondarySortClass);if(a!=""){jQuery(this).removeClass(a);return this}a=jQuery(this).parent("th");if(a.length!=0){var b=jQuery(a).eq(0).sortCheckForClass(sortTableVars.secondarySortClass);if(b!=""){jQuery(a).eq(0).removeClass(b);return this}}a=jQuery(this).parent("td");if(a.length!=0){b=jQuery(a).eq(0).sortCheckForClass(sortTableVars.secondarySortClass);if(b!=""){jQuery(a).eq(0).removeClass(b);return this}}return this};
jQuery.fn.setSortArrow=function(a,b){if(b!=false)b=true;jQuery(this).find("."+sortTableVars.sortArrowClass).length==0&&jQuery(this).append("<span class='"+sortTableVars.sortArrowClass+"'></span>");b&&jQuery(this).parents("table").eq(0).find("."+sortTableVars.sortArrowClass).empty();jQuery(this).removeClass(sortTableVars.sortDirectionAscClass).removeClass(sortTableVars.sortDirectionDesClass).find("."+sortTableVars.sortArrowClass).eq(0).empty();if(a==1)jQuery(this).addClass(sortTableVars.sortDirectionAscClass).find("."+
sortTableVars.sortArrowClass).eq(0).html(sortTableVars.ascSortArrow);else a==-1&&jQuery(this).addClass(sortTableVars.sortDirectionDesClass).find("."+sortTableVars.sortArrowClass).eq(0).html(sortTableVars.descSortArrow);return this};
jQuery.fn.sortTableColumn=function(a,b,d,g){dataType_alpha=function(c){if(jQuery.browser.msie){var e=c.html().replace(/&nbsp;+/g," ");c.html(e)}return jQuery.trim(c.find("."+sortTableVars.sortKeyClass).text().toUpperCase())+" "+jQuery.trim(c.text().toUpperCase())};dataType_numeric=function(c){var e=c.text();if(c.find("."+sortTableVars.sortKeyClass).length>0)e=c.find("."+sortTableVars.sortKeyClass).eq(0);c=parseFloat(e.replace(/^[^\d.]*/,""));return isNaN(c)?0:c};dataType_date=function(c){if(jQuery.browser.msie){var e=
c.html().replace(/&nbsp;+/g," ");c.html(e)}e=jQuery.trim(c.text());if(c.find("."+sortTableVars.sortKeyClass).length>0)e=jQuery.trim(c.find("."+sortTableVars.sortKeyClass).eq(0));return e.substr(6,4)+e.substr(0,2)+e.substr(3,2)};sort_default=function(c,e){for(var j=0;j<c.sortKey.length;j++){if(c.sortKey[j]>e.sortKey[j])return c.sortDirection[j];if(c.sortKey[j]<e.sortKey[j])return-c.sortDirection[j]}return 0};checkSecondarySort=function(c){c=jQuery(c).sortCheckForClass(sortTableVars.secondarySortClass);
if(c=="")return"";c=c.split("_");c.shift();if(c.length%2!=0){alert("incorrect number of items set in the secondarySort class");return""}for(var e=[],j=0;j<c.length;j+=2)e.push(new Array(c[j],c[j+1]));return e};var h=false,i;if(typeof a!="object"){i=new Array(new Array(a,b,d));h=true}else{i=a;g=b}var f,k,r,o=i[0][0];d=i[0][1];f=jQuery(this).getTagName();if(f=="table"||f=="TABLE"){k=this;if(o==undefined){alert("No column index was passed to the sortTableColumn function - sorting did not happen.");return this}headerRow=
jQuery(k).find("tr."+sortTableVars.sortHeaderRowClass).length>0?jQuery(k).find("tr."+sortTableVars.sortHeaderRowClass).eq(0):jQuery(k).find("thead").length>0?jQuery(k).find("thead tr:last"):jQuery(k).find("tr:first");f=jQuery(headerRow).children().eq(o);r=jQuery(f).find("."+sortTableVars.sortHeaderClass).eq(0)}else if(f=="td"||f=="TD"||f=="th"||f=="TH"){f=this;headerRow=jQuery(f).parents("tr").eq(0);k=jQuery(this).parents("table").eq(0);r=jQuery(this).find("."+sortTableVars.sortHeaderClass).eq(0)}else if((f==
"a"||f=="A")&&jQuery(this).hasClass(sortTableVars.sortHeaderClass)){f=jQuery(this).parents("th").length>0?jQuery(this).parents("th").eq(0):jQuery(this).parents("td").eq(0);headerRow=jQuery(f).parents("tr").eq(0);k=jQuery(this).parents("table").eq(0);r=this}else{alert("Improper object daisy-chained to the sortTableColumn function - sorting did not happen.");return this}if(h){h=checkSecondarySort(f);if(h!=""&&h.length>0)for(var l=0;l<h.length;l++)i.push(h[l])}if(o==undefined||o==""){h=jQuery(f).parents("tr").eq(0);
var s;jQuery(f).each(function(){s=this});jQuery(h).find("th").each(function(c){if(this==s)i[0][0]=c});if(a==undefined||a=="")jQuery(h).find("td").each(function(c){if(this==s)i[0][0]=c});o=i[0][0]}h=jQuery(k).find("tbody > tr").get();for(var n=0;n<i.length;n++){a=i[n][0];b=i[n][1];var m=i[n][2];if(b==0)b=d;if(b==undefined||b==""||b!=1&&b!=-1){b=jQuery(headerRow).children().eq(a).find("."+sortTableVars.sortHeaderClass).eq(0).hasClass(sortTableVars.sortDirectionAscClass)?-1:1;if(n==0)d=b}if(m==undefined||
m==""){m="";if(l=jQuery(headerRow).children().eq(a).sortCheckForClass(sortTableVars.sortKeyClassStart))m=eval(l)}if(m==""){m=dataType_alpha;jQuery(headerRow).children().eq(a).addClass("dataType_alpha");var p="";for(l=0;p=="";l++){var q=jQuery(k).find("tbody tr").eq(l).find("td").eq(a);if(jQuery.browser.msie){var t=jQuery(q).html().replace(/&nbsp;+/g," ");jQuery(q).html(t)}q=jQuery.trim(jQuery(k).find("tbody tr").eq(l).find("td").eq(a).text());if(q!="")p=q}if(p.match(/^\d\d[\/-]\d\d[\/-]\d\d\d\djQuery/)){m=
dataType_date;jQuery(headerRow).children().eq(a).removeClass("dataType_alpha").addClass("dataType_date")}if(p.match(/^\d\d[\/-]\d\d[\/-]\d\djQuery/)){m=dataType_date;jQuery(headerRow).children().eq(a).removeClass("dataType_alpha").addClass("dataType_date")}if(p.match(/^[\u00a3jQuery]/)){m=dataType_numeric;jQuery(headerRow).children().eq(a).removeClass("dataType_alpha").addClass("dataType_numeric")}if(p.match(/^[\d\.]+jQuery/)){m=dataType_numeric;jQuery(headerRow).children().eq(a).removeClass("dataType_alpha").addClass("dataType_numeric")}}jQuery.each(h,
function(c,e){if(n==0){e.sortKey=[];e.sortDirection=[]}e.sortKey[n]=m(jQuery(e).children("td").eq(a));e.sortDirection[n]=b})}if(g==undefined||g==""){g="";l=jQuery(f).sortCheckForClass(sortTableVars.sortFunctionClassStart);if(l!="")sortKey=eval(l)}if(g==""){g=sort_default;jQuery(f).addClass("sort_default")}h.sort(g);jQuery.each(h,function(c,e){jQuery(k).children("tbody").append(e);jQuery(e).find("."+sortTableVars.sortedColumnClass).removeClass(sortTableVars.sortedColumnClass);jQuery(e).find("td").eq(o).addClass(sortTableVars.sortedColumnClass);
e.sortKey=null;e.sortDirection=null});jQuery(f).parents("tr").eq(0).find("."+sortTableVars.sortedColumnClass).removeClass(sortTableVars.sortedColumnClass);jQuery(f).addClass(sortTableVars.sortedColumnClass);jQuery(k).alternateRowColors();jQuery(r).setSortArrow(d);return this};jQuery.fn.sortCheckForClass=function(a){var b=[];a=new RegExp(a);b=jQuery(this).attr("class").split(" ");for(var d=0;d<b.length;d++)if(b[d].match(a))return b[d];return""};
jQuery.fn.getTagName=function(){var a="";jQuery(this).each(function(){a=this.tagName});return a};jQuery.fn.sortGetParentCell=function(){var a=jQuery(this).getTagName();if(a=="th"||a=="TH"||a=="td"||a=="TD")return this;a=jQuery(this).parent("th");if(a.length>0)return a.eq(0);a=jQuery(this).parent("td");if(a.length>0)return a.eq(0);return this};
jQuery.fn.sortGetTableCellIndex=function(){var a=jQuery(this).sortGetParentCell(),b=jQuery(a).parents("tr").eq(0),d,g="";jQuery(a).each(function(){d=this});jQuery(b).find("th").each(function(h){if(this==d){g=h;alert("th "+h)}});if(g==undefined||g=="")jQuery(b).find("td").each(function(h){if(this==d)g=h});return g};